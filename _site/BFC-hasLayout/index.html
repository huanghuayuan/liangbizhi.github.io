<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="author" content="liangbizhi" />
    <meta name="keywords" content="前端,梁必志,liangbizhi,Bill Liang,BFC与hasLayout" />
    <meta name="description" content="前端博客，博主脑袋有点异常。BFC与hasLayout" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>BFC与hasLayout</title>
    <link rel="shortcut icon" href="/media/images/favicon.ico" />
    <link rel="stylesheet" href="/media/css/style.css" />
    <link rel="stylesheet" href="/media/css/iconfont.css" />
    <link rel="stylesheet" href="/media/css/highlight.css" />
    <!--<link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml" />-->
    <!--[if lt IE 9]>
    <div class="bsie">
        您的浏览器版本过旧，请升级为Google Chrome浏览器进行浏览 :-D
        <a href="javascript:void(0);" onclick="this.parentNode.style.display='none';">关闭</a>
    </div>
    <![endif]-->
</head>

<body>
   <!--header-->
    <header id="header" class="">
        <i id="btn-open-sidebar" class="icon iconfont">&#xe60a;</i>
        <h1 class="header-title"><a class="header-title-link" href="/">必先苦其心志</a></h1>
        <a class="header-right-picture" href="/about/" title="liangbizhi">
            <img class="header-picture" src="/media/images/avatar.png" alt="头像">
        </a>
    </header>
    <!--sidebar-->
    <nav id="sidebar">
        <div class="sidebar-profile">
            <a href="/about/" title="liangbizhi">
                <img src="/media/images/avatar.png" alt="头像" class="sidebar-profile-picture">
            </a>
            <span class="sidebar-profile-name">liangbizhi</span>
        </div>
        <ul class="sidebar-buttons">
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/">
                        <i class="icon iconfont">&#xe603;</i>
                        <span class="sidebar-button-desc">主&nbsp;&nbsp;&nbsp;&nbsp;页</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/categories/">
                        <i class="icon iconfont">&#xe601;</i>
                        <span class="sidebar-button-desc">分&nbsp;&nbsp;&nbsp;&nbsp;类</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/tags/">
                        <i class="icon iconfont">&#xe609;</i>
                        <span class="sidebar-button-desc">标&nbsp;&nbsp;&nbsp;&nbsp;签</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="/guestbook/">

                        <i class="icon iconfont">&#xe606;</i>
                        <span class="sidebar-button-desc">留&nbsp;&nbsp;&nbsp;&nbsp;言</span>
                    </a>
            </li>

            <li class="sidebar-button">

                    <a class="sidebar-button-link st-search-show-outputs" href="/about/">

                        <i class="icon iconfont">&#xe604;</i>
                        <span class="sidebar-button-desc">关&nbsp;&nbsp;&nbsp;&nbsp;于</span>
                    </a>
            </li>

            <li class="sidebar-button">

                    <a class="sidebar-button-link " href="javascript:void(0);">

                        <i class="icon iconfont">&#xe607;</i>
                        <span class="sidebar-button-desc">搜&nbsp;&nbsp;&nbsp;&nbsp;索</span>
                    </a>
            </li>

        </ul>
        <ul class="sidebar-buttons">
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="http://github.com/liangbizhi/" target="_blank">
                        <i class="icon iconfont">&#xe605;</i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="https://plus.google.com/107690026046415883872" target="_blank">
                        <i class="icon iconfont">&#xe608;</i>
                        <span class="sidebar-button-desc">Google Plus</span>
                    </a>
            </li>
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="http://weibo.com/bikuqixinzhi" target="_blank">
                        <i class="icon iconfont">&#xe602;</i>
                        <span class="sidebar-button-desc">Weibo</span>
                    </a>
            </li>

        </ul>
        <ul class="sidebar-buttons">
            <li class="sidebar-button">
                    <a class="sidebar-button-link " href="#">
                        <i class="icon iconfont">&#xe600;</i>
                        <span class="sidebar-button-desc">RSS订阅</span>
                    </a>
            </li>
        </ul>
    </nav>
    <div id="main" role="main">
        <header>
            <h1>BFC与hasLayout</h1>
        </header>
        <article class="content">
            <section class="meta">
<span class="time">
  <time datetime="2015-04-25">2015-04-25</time>
</span>

 | 
<span class="categories">
  分类
  
  <a href="/categories/#前端" title="前端">前端</a>&nbsp;
  
</span>


 | 
<span class="tags">
  标签
  
  <a href="/tags/#css" title="css">css</a>&nbsp;
  
  <a href="/tags/#浏览器" title="浏览器">浏览器</a>&nbsp;
  
</span>

</section>
<section class="post">
<p>最近在GitHub上关注百度前端技术学院ife的课程。参考了不少博客，学到了很多，下面来总结一下BFC和hasLayout的理解。</p>

<h1>什么是BFC</h1>

<p>BFC(Block Formatting Context)，可以译为“块级格式化上下文”。一开始感觉挺难懂的。我所理解的上下文是元素所在的作用范围或环境，以及在这个范围或环境中产生的关系。</p>

<p>它是CSS 2.1规范中的概念。可以到<code>www.w3.org</code>查看该规范。它决定了元素如何对其内容进行定位，以及与其他元素的关系和相互作用。一个环境中的元素不会影响到其它环境中的布局。比如浮动元素会<strong>形成BFC</strong>，浮动元素内部子元素的主要受该浮动元素影响，两个浮动元素之间是互不影响的。这里有点类似一个BFC就是一个独立的行政单位的意思。也可以说BFC就是一个作用范围。</p>

<h2>几个BFC表现</h2>

<ol>
<li><p>创建了BFC的元素中，它的子元素们按文档流一个接一个地放置。相邻两个元素之间的垂直距离取决于<code>margin</code>属性。举个例子好了，一般垂直方向上的<code>margin</code>是会合并的。但如果为它们创建了不同的BFC后，它们的<code>margin</code>就<strong>不会合并</strong>了。</p></li>
<li><p>BFC是页面上一个隔离的独立容器，里面的子元素不会在布局上影响到外面的元素；外面的元素也不会影响到里面的元素。</p></li>
<li><p>创建了BFC的元素不能与浮动元素重叠。这个可以用来实现<strong>自适应宽度布局</strong>。</p></li>
<li><p>根据CSS 2.1规范的高度计算规则，在计算BFC元素高度时，其浮动子元素应该参与计算。利用这个可以实现<strong>闭合浮动</strong>（避免高度坍塌）。</p></li>
</ol>

<p>还有其他一些规则（4个），详见参考博客。</p>

<h1>什么是IE的hasLayout</h1>

<p><code>hasLayout</code>是IE浏览器渲染引擎的一个内部组成部分。在IE浏览器中，一个元素要么自己对自身的内容进行组织和计算大小，要么依赖于包含块来计算尺寸和组织内容。为了协调这两种方式的矛盾，渲染引擎采用了<code>hasLayout</code>属性，属性值可以为<code>true</code>或<code>false</code>。当一个元素的<code>hasLayout</code>属性值为<code>true</code>时，我们说这个元素有一个布局（layout），或拥有布局。</p>

<p><code>hasLayout</code>与BFC有很多相似之处。一个元素触发<code>hasLayout</code>会影响一个元素的尺寸和定位，这样会消耗更多的系统资源，因此 IE设计者默认只为一部分的元素触发<code>hasLayout</code>（即默认有部分元素会触发<code>hasLayout</code>，这与BFC基本完全由开发者通过特定CSS触发并不一样）。</p>

<p>特别注意的是，<code>hasLayout</code>在IE 8+已经被抛弃，所以在实际开发中只需针对IE 8以下的浏览器为某些元素触发<code>hasLayout</code>。</p>

<h1>一个简单的例子</h1>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="lineno"> 1</span> * {margin: 0; padding: 0}
<span class="lineno"> 2</span>  .black, .blue, .yellow, .green {
<span class="lineno"> 3</span>      float: left;
<span class="lineno"> 4</span>      height: 100px;
<span class="lineno"> 5</span>      width: 100px;
<span class="lineno"> 6</span>  }
<span class="lineno"> 7</span>  .black {background-color: black;}
<span class="lineno"> 8</span>  .blue {background-color: blue;}
<span class="lineno"> 9</span>  .yellow {background-color: yellow;}
<span class="lineno">10</span>  .green {background-color: green;}
<span class="lineno">11</span>  p{margin-left: 50px; background-color: red;}
<span class="lineno">12</span>  
<span class="lineno">13</span>  ...
<span class="lineno">14</span> 
<span class="lineno">15</span>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;c1&quot;</span><span class="nt">&gt;</span>
<span class="lineno">16</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;black&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="lineno">17</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;blue&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="lineno">18</span>  <span class="nt">&lt;/div&gt;</span>
<span class="lineno">19</span>  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;c2&quot;</span><span class="nt">&gt;</span>
<span class="lineno">20</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;yellow&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="lineno">21</span>      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;green&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="lineno">22</span>  <span class="nt">&lt;/div&gt;</span>
<span class="lineno">23</span>  <span class="nt">&lt;p&gt;</span>我是一个margin-left: 50px的段<span class="nt">&lt;/p&gt;</span></code></pre></div>

<p>显示效果如下：</p>

<p><img src="/media/images/BFC-hasLayout/1.jpg" alt=""></p>

<p>本意上是想形成两行两列的布局，但是由于.black，.blue，.yellow，.green四个div在同一个布局环境BFC中，因此虽然它们位于两个不同的div（.c1和.c2）中，但仍然不会换行，而是一行四列的排列。</p>

<p>怎么解决？就要为.c1和.c2创建两个不同的BFC了。</p>

<h1>如何创建BFC</h1>

<p>当一个HTML元素满足下面条件的<strong>任何一点</strong>，都可以产生BFC：</p>

<ul>
<li><code>float</code>值非none。</li>
<li><code>overflow</code>值非visible。</li>
<li><code>display</code>值为table-cell, table-caption, inline-block任一个。</li>
<li><code>position</code>值非relative和static。</li>
</ul>

<p>所以为上面例子加代码即可创建两个不同的BFC，它们各自的布局不会影响到外部元素：</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="lineno">1</span> .c1{ overflow: hidden; }
<span class="lineno">2</span>   .c2{ overflow: hidden; }</code></pre></div>

<p><img src="/media/images/BFC-hasLayout/2.jpg" alt=""></p>

<h1>如何触发hasLayout</h1>

<p>除了IE默认会触发<code>hasLayout</code>的元素外（详见参考），还可以使用特定的CSS触发元素的hasLayout。</p>

<p>综合考虑浏览器之间的兼容和对元素的影响，建议使用zoom: 1来触发元素的hasLayout。</p>

<h1>BFC的几大用处</h1>

<h2>防止margin折叠</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">div{
    overflow: hidden;
    background-color: blue;
}
p{
    margin: 20px;
}

&lt;p&gt;this is paragraph&lt;/p&gt;
&lt;p&gt;this is paragraph&lt;/p&gt;
&lt;div&gt;
  &lt;p&gt;this is paragraph whose parent create a new block context&lt;/p&gt;
&lt;/div&gt;
</code></pre></div>
<p>因为创建了BFC,所以被div包含的p与它前面那个兄弟元素p之间有40个px单位，而不是20个。</p>

<h2>闭合浮动</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text">div{
    background: blue
}
.float{
    float:left;

}
.new{
    overflow: hidden;
}

&lt;div class=new&gt;
    &lt;p class=float&gt;this is a float p tag in a blue background div tag&lt;/p&gt;
&lt;/div&gt;
&lt;div&gt;
    &lt;p class=float&gt;this is a float p tag in a blue background div tag&lt;/p&gt;
&lt;/div&gt;
</code></pre></div>
<p>.new的div会有一个蓝色背景，因为通过overflow: hidden属性创建了BFC, 根据上面第4条BFC表现规则，浮动元素的高度会参与父元素的高度的计算，所以闭合了浮动。</p>

<p>而另外一个div则会“坍塌”，看不到背景。</p>

<h2>BFC元素不会环绕float</h2>

<p>根据第3条规则，产生一个新的BFC会改变元素与float元素的交互方式——这个元素将不再是环绕着float元素。与此同时，这个元素还会占据这一行剩下的所有空间。</p>

<p>利用这一点可以用来做自适应的双栏布局或者三栏布局。</p>

<p>例子：</p>

<p><a href="http://jsfiddle.net/kkeys/9RVnt/" title="双栏布局">双栏布局</a></p>

<p><a href="http://jsfiddle.net/kkeys/wS3pD/" title="三栏布局">三栏布局</a></p>

<h1>参考</h1>

<p><a href="http://www.cnblogs.com/pigtail/archive/2013/01/23/2871627.html">http://www.cnblogs.com/pigtail/archive/2013/01/23/2871627.html</a></p>

<p><a href="http://outofmemory.cn/wr/?u=http%3A%2F%2Fkkeys.me%2Fpost%2F68547473290">http://outofmemory.cn/wr/?u=http%3A%2F%2Fkkeys.me%2Fpost%2F68547473290</a></p>

</section>
<section class="page-nav">
    <br/>
    <p><a  href="/clear-float/" class=""  >下一篇：各种清除浮动</a></p>
    <p><a  href="/sublime-frontend/" class=""  >上一篇：Web前端sublime使用技巧</a></p>
</section>

	
	<div class="ds-thread" data-thread-key="/BFC-hasLayout" data-url="http://liangbizhi.github.io/BFC-hasLayout/" data-title="BFC与hasLayout" />
		
	<script type="text/javascript">
	/* duoshuo */
	var duoshuoQuery = {short_name:"liangbizhi"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>



        </article>
        <footer>
        <p>Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> &#64;
            <a href="http://github.com/liangbizhi/liangbizhi.github.io" target="_blank" title="项目主页">GitHub</a>
            | © 2014 - 2015 <a href="/about/">liangbizhi</a>
        </p>
        </footer>
    </div>
</body>
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-61782303-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript" src="/media/js/script.js"></script>
</html>